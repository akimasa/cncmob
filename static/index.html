<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
<script type="text/html" id="ch-template">
<div>
	<%= (new Date(start)).toLocaleTimeString() %>
	ã€œ
	<%= (new Date(end)).toLocaleTimeString() %>
	<div>
	<%= id %>
	</div>
	<div>
	<%= title %>
	</div>
</div>
</script>
<script>
var Router = Backbone.Router.extend({
	routes: {
		"programs/:id": "programs"
	},
	programs: function(query, page){
		console.log(query,page);
	}
});
var router = new Router();
Backbone.history.start();
var Schedules = Backbone.Collection.extend({
	url: apipoint+"/schedule.json"
});
var schedules = new Schedules();
schedules.fetch({
	success: function(collection, res, opts){
		console.log(res);
		schedules.each(function(e,i){
			console.log(e.get("programs"),i);
			var MyView = Backbone.View.extend({
				render:function(){
					this.$el.append($("<b>").text(e.get("name")).attr("id",e.get("id"))
							.click(function(ev){
						router.navigate("programs/"+e.get("id"));
						ev.preventDefault();
					}));
					var that = this;
					var template = _.template($("#ch-template").html());
					_.each(e.get("programs"),function(e2,i){
						if(i > 10){
							return;
						}
						that.$el.append(template(e2));
						//console.log(e,i);
					});
					return this;
				}
			});
			var myView = new MyView();
			$("body").append(myView.render().el);
		});
	}
})
</script>
<body>
</body>
